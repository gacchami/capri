#!/usr/bin/perl# プロバイダーのパス#================## プログラム情報 ##================## ----------------------------------------------------------##                                                           ##    MAIL FORM Ver.1.10                                     ##    Produced by [Genesis]                                  ##                                                           ##    URL: http://genesis.vis.ne.jp/                         ##    E-Mail: genesis@mi.vis.ne.jp                           ##                                                           ##    配布開始日　2001/07/01                                 ##    最終更新日　2003/09/11                                 ##                                                           ##    リンクを表示させる場合は                               ##    以下のタグを表示させたい部分に入れます。               ##                                                           ##    <a href="./mail.html">MAIL FORM</a>                    ##                                                           ## ----------------------------------------------------------## --+--初期設定ここから-------------------------------------+--# -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-# ファイル名の設定(基本的に変更しないでください。)# -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-# 日本語変換コードまでのパスrequire 'jcode.pl';# 送信後に表示するページ（「.html」「.shtml」「.swf」など）$end = "end.html";# 送信文の外部ファイルまでのパス$send_txt = "send.txt";# -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-# 運営上に必要な設定です。# -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-# センドメールのパス$mail_pass = '/usr/sbin/sendmail';# 送信先メールアドレス（必ず記入してください。）$mail_to = 'osaken91@yahoo.co.jp';# 複数にメールを送信する場合ここにアドレスを書いてください。# 必要ない場合は「$mail_bcc = '';」に# （アドレスとアドレスはカンマで区切ってください。）$mail_bcc = '';# HTMLメールを許可する(しない＝1、する＝0)$tag = '1';# --+--初期設定ここまで-------------------------------------+--# ----------------------------------------# ここから下は変更しないでください。# 変更するにはperlの知識が必要になります。# ----------------------------------------if ($ENV{'REQUEST_METHOD'} eq "POST") { read(STDIN, $buffer, $ENV{'CONTENT_LENGTH'}); }    else { $buffer = $ENV{'QUERY_STRING'}; }@pairs = split(/&/,$buffer);foreach $pair (@pairs) {    ($name, $value) = split(/=/, $pair);    $value =~ tr/+/ /;    $value =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C", hex($1))/eg;        &jcode'convert(*value,'sjis');        if ($tag) {        $value =~ s/</\&lt\;/g;        $value =~ s/>/\&gt\;/g;        $value =~ s/\"/\&quot\;/g;        $value =~ s/<>/\&lt\;\&gt\;/g;        $value =~ s/<!--(.|\n)*-->//g;    }        $FORM{$name} = $value;    }print "Content-type:text/html;\n\n";$a0 = $FORM{'a0'};$a1 = $FORM{'a1'};$a2 = $FORM{'a2'};$a3 = $FORM{'a3'};$a4 = $FORM{'a4'};$a5 = $FORM{'a5'};$a6 = $FORM{'a6'};$a7 = $FORM{'a7'};$a8 = $FORM{'a8'};$a9 = $FORM{'a9'};$mail = $FORM{'mail'};$necessary = $FORM{'necessary'};$ENV{'TZ'} = "JST-9";($sec,$min,$hour,$mday,$mon,$year,$wday) = localtime(time);$mon++;$week = ('Sun','Mon','Tue','Wed','Thu','Fri','Sat') [$wday];$year += 1900;if ($sec <10) { $sec ="0$sec";}if ($min <10) { $min ="0$min";}if ($hour <10) { $hour ="0$hour";}if ($mday <10) { $mday ="0$mday";}if ($mon <10) { $mon ="0$mon";}$date = "$year/$mon/$mday $hour:$min ($week)";open (IN,"$send_txt") || &error("メール送信文がありません。");$send = join('',<IN>);close(IN);$send =~ s/<!--a0-->/$a0/i;$send =~ s/<!--a1-->/$a1/i;$send =~ s/<!--a2-->/$a2/i;$send =~ s/<!--a3-->/$a3/i;$send =~ s/<!--a4-->/$a4/i;$send =~ s/<!--a5-->/$a5/i;$send =~ s/<!--a6-->/$a6/i;$send =~ s/<!--a7-->/$a7/i;$send =~ s/<!--a8-->/$a8/i;$send =~ s/<!--a9-->/$a9/i;$send =~ s/<!--date-->/$date/i;$send =~ s/<!--mail-->/$mail/i;@NECESSARY = split(/,/,$necessary);foreach (@NECESSARY) { if ($$_ eq "") { &error("必須項目にエラーがあります。"); } }open (IN,"$send_txt") || &error("メール送信文がありません。");$subject = <IN>;close(IN);	    open(MAIL,"| $mail_pass -t -f $mail_to") || &error("Can't do sendmail");		print MAIL 'X-Mailer: MAILER' . "\n";        print MAIL "To: $mail_to\n";        print MAIL "Bcc: $mail_bcc\n";	    print MAIL "From: $mail\n";	    print MAIL "Subject: $subject \n";		print MAIL "Content-Transfer-Encoding: 7bit\n";		print MAIL "$send\n";	    close(MAIL);    open (IN,"$end");while(<IN>){ print; }close(IN);exit;sub error {print <<"EOM";<HTML><HEAD><title>- ERROR -</title></HEAD><BODY><CENTER><BR><BR><BR>- ERROR -<BR><BR><BR>$_[0]<BR><BR><BR><BR>前のページにお戻りください。<BR><BR><BR><BR><BR><A href="javascript:history.go(-1)">戻る</A><BR><BR><BR><BR><BR><HR color="#cccccc" width="200" size="1"><!-- 著作権です。消さないで下さい。 --><FONT style="letter-spacing:2px;">- <a href="http://genesis.vis.ne.jp/" target="_blank">Genesis</a> -</FONT><BR><BR></CENTER></BODY></HTML>EOMexit;}